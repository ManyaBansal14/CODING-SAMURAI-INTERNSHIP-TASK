<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To-Do List App</title>
    <!-- Tailwind CSS CDN for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Confetti library CDN -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 1rem;
        }
        .task-list li.completed .task-text {
            text-decoration: line-through;
            color: #9ca3af;
        }
    </style>
</head>
<body class="bg-gray-100 font-sans">

    <div class="bg-white p-8 rounded-xl shadow-2xl w-full max-w-lg">
        <h1 class="text-3xl font-bold text-center text-gray-800 mb-6">My To-Do List</h1>

        <!-- Task input section -->
        <div class="flex flex-col sm:flex-row items-center space-y-4 sm:space-y-0 sm:space-x-4 mb-6">
            <input type="text" id="task-input" placeholder="Add a new task..."
                   class="flex-1 w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500">
            <select id="task-priority" class="px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500">
                <option value="easy">Easy</option>
                <option value="medium">Medium</option>
                <option value="hard">Hard</option>
            </select>
            <button id="add-task-btn"
                    class="w-full sm:w-auto px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 transition-colors duration-200">
                Add Task
            </button>
        </div>

        <!-- Task list container -->
        <ul id="task-list" class="space-y-4">
            <!-- Tasks will be dynamically added here -->
        </ul>
    </div>

    <script>
        // Get DOM elements
        const taskInput = document.getElementById('task-input');
        const taskPriority = document.getElementById('task-priority');
        const addTaskBtn = document.getElementById('add-task-btn');
        const taskList = document.getElementById('task-list');

        // Load tasks from local storage
        document.addEventListener('DOMContentLoaded', () => {
            const tasks = JSON.parse(localStorage.getItem('tasks')) || [];
            tasks.forEach(task => renderTask(task));
        });

        // Add task functionality
        addTaskBtn.addEventListener('click', () => {
            const taskText = taskInput.value.trim();
            if (taskText) {
                const newTask = {
                    id: Date.now(),
                    text: taskText,
                    completed: false,
                    priority: taskPriority.value // Capture priority
                };
                saveTask(newTask);
                renderTask(newTask);
                taskInput.value = ''; // Clear input field
            }
        });

        // Event listener for task list (using event delegation)
        taskList.addEventListener('click', (event) => {
            const target = event.target;
            const listItem = target.closest('li');

            if (!listItem) return;

            const taskId = parseInt(listItem.dataset.taskId);
            const tasks = JSON.parse(localStorage.getItem('tasks'));
            const taskIndex = tasks.findIndex(task => task.id === taskId);

            if (target.classList.contains('delete-btn')) {
                // Delete task
                listItem.remove();
                tasks.splice(taskIndex, 1);
                updateLocalStorage(tasks);
            } else if (target.classList.contains('complete-btn')) {
                // Remove task and trigger confetti when completed
                listItem.remove();
                tasks.splice(taskIndex, 1);
                updateLocalStorage(tasks);
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
            } else if (target.classList.contains('edit-btn')) {
                // Edit task
                const taskTextElement = listItem.querySelector('.task-text');
                const newText = prompt('Edit your task:', taskTextElement.textContent);
                if (newText !== null && newText.trim()) {
                    taskTextElement.textContent = newText.trim();
                    tasks[taskIndex].text = newText.trim();
                    updateLocalStorage(tasks);
                }
            }
        });

        // Function to save a new task to local storage
        function saveTask(task) {
            const tasks = JSON.parse(localStorage.getItem('tasks')) || [];
            tasks.push(task);
            localStorage.setItem('tasks', JSON.stringify(tasks));
        }

        // Function to update local storage with the current tasks array
        function updateLocalStorage(tasks) {
            localStorage.setItem('tasks', JSON.stringify(tasks));
        }

        // Function to render a task to the DOM
        function renderTask(task) {
            const li = document.createElement('li');
            li.dataset.taskId = task.id;
            li.className = 'flex items-center justify-between p-4 bg-gray-50 rounded-lg shadow-sm transform transition-transform duration-200 hover:scale-[1.01]';

            if (task.completed) {
                li.classList.add('completed');
            }

            // Determine priority color
            let priorityColor = '';
            switch (task.priority) {
                case 'easy':
                    priorityColor = 'bg-green-500';
                    break;
                case 'medium':
                    priorityColor = 'bg-yellow-500';
                    break;
                case 'hard':
                    priorityColor = 'bg-red-500';
                    break;
                default:
                    priorityColor = 'bg-gray-400';
            }

            li.innerHTML = `
                <div class="flex items-center flex-1 min-w-0">
                    <span class="task-text text-lg font-medium text-gray-700 truncate">${task.text}</span>
                    <span class="ml-3 px-2 py-1 text-xs font-semibold text-white rounded-full ${priorityColor}">${task.priority.toUpperCase()}</span>
                </div>
                <div class="flex space-x-2 ml-4">
                    <button class="complete-btn p-2 text-white bg-green-500 rounded-full hover:bg-green-600 transition-colors duration-200">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                    </button>
                    <button class="edit-btn p-2 text-white bg-blue-500 rounded-full hover:bg-blue-600 transition-colors duration-200">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zm-5.49 5.204L3 14.88V17h2.12l5.774-5.773-2.12-2.12z" />
                        </svg>
                    </button>
                    <button class="delete-btn p-2 text-white bg-red-500 rounded-full hover:bg-red-600 transition-colors duration-200">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" />
                        </svg>
                    </button>
                </div>
            `;
            taskList.appendChild(li);
        }
    </script>

</body>
</html>
